import{J as os,h as d,H as as,k as V,l as ls,G as is,c as u,a as s,b as t,i as y,n as g,t as i,F as w,f as E,d as h,w as K,E as cs,x as B,g as rs,y as us,r as D,o as c,z as ds}from"./Ce4noQ1C.js";import{_ as vs}from"./DlAUqK2U.js";const ms={class:"booking-page"},gs={class:"progress-container"},hs={class:"progress-steps"},ps={class:"step-circle"},_s={class:"step-circle"},ys={class:"step-circle"},bs={class:"main-content"},fs={class:"room-card"},ks={key:0,class:"loading-container"},Ts={key:1,class:"room-content"},Ns={class:"room-header"},Cs={key:0,class:"room-badge"},Vs={class:"room-title"},ws={class:"room-rating"},Ds={class:"stars"},Ps={class:"room-gallery"},Ls={class:"main-image"},Ss=["src","alt"],Ms={class:"image-overlay"},Es={class:"image-indicators"},Is=["onClick"],xs={class:"room-details"},$s={class:"detail-grid"},Gs={class:"detail-item"},Bs={class:"detail-icon"},Os={class:"detail-content"},Us={class:"detail-value"},As={class:"detail-item"},Fs={class:"detail-icon"},Hs={class:"detail-content"},zs={class:"detail-value"},Rs={class:"detail-item"},qs={class:"detail-icon"},Js={class:"detail-content"},Ks={class:"detail-value"},Ws={class:"detail-item price-item"},Xs={class:"detail-icon"},js={class:"detail-content"},Ys={class:"detail-value price"},Qs={class:"room-description"},Zs={class:"amenities-section"},sn={class:"amenities-grid"},nn={class:"amenity-icon"},en=["src","alt"],tn={class:"amenity-text"},on={class:"room-status"},an={key:0,class:"urgency-message"},ln={class:"urgency-content"},cn={class:"booking-form"},rn={class:"form-header"},un={class:"form-title"},dn={class:"form-content"},vn={class:"form-section"},mn={class:"section-title"},gn={class:"form-group"},hn={class:"input-wrapper"},pn={class:"form-group"},_n={class:"input-wrapper"},yn={class:"form-section"},bn={class:"section-title"},fn={class:"date-inputs"},kn={class:"form-group"},Tn={class:"input-wrapper"},Nn={class:"form-group"},Cn={class:"input-wrapper"},Vn={key:0,class:"stay-summary"},wn={class:"summary-item"},Dn={class:"summary-item total-price"},Pn={class:"form-section"},Ln={class:"section-title"},Sn={class:"guest-counters"},Mn={class:"counter-group"},En={class:"counter-info"},In={class:"counter-controls"},xn=["disabled"],$n={class:"counter-value"},Gn=["disabled"],Bn={class:"counter-group"},On={class:"counter-info"},Un={class:"counter-controls"},An=["disabled"],Fn={class:"counter-value"},Hn=["disabled"],zn={class:"form-section"},Rn={class:"section-title"},qn={class:"form-group"},Jn={class:"booking-summary"},Kn={class:"summary-title"},Wn={class:"summary-details"},Xn={class:"summary-row"},jn={class:"summary-row"},Yn={key:0,class:"summary-row"},Qn={class:"summary-row"},Zn={class:"summary-row price-breakdown"},se={key:1,class:"summary-row total-row"},ne={class:"total-amount"},ee={class:"form-section"},te={class:"section-title"},oe={class:"service-option"},ae=["src"],le={class:"service-price"},ie={key:0,class:"service-counter-list"},ce=["src"],re={class:"counter"},ue=["onClick"],de=["onClick"],ve={class:"form-actions"},me=["disabled"],ge={class:"btn-content"},he={key:1,class:"loading-spinner-btn"},pe={class:"form-note"},_e={class:"success-icon"},ye={class:"toast-content"},be={__name:"DatPhong",setup(fe){const W=as(),{$api:X}=os(),e=d({cccd:"",sdt:"",ngayNhan:"",ngayTra:"",soNguoiLon:1,soTreEm:0,yeuCau:""}),r=d({tienNghiList:[],giaPhong:0}),O=d(!0),I=d(!1),b=d(!1),x=d(!1),P=d(!1),U=d(""),$=d("success"),m=d(1),p=d(0);let f=[];const v=d({cccd:"",sdt:"",ngayNhan:"",ngayTra:""}),A=W.params.maPhong,L=d(["https://images.unsplash.com/photo-1566073771259-6a8506099945","https://images.unsplash.com/photo-1582719478250-c89cae4dc85b","https://images.unsplash.com/photo-1595576508898-0ad5c879a061"]),F=d(""),H=V(()=>new Date().toISOString().split("T")[0]),k=V(()=>{if(!e.value.ngayNhan||!e.value.ngayTra)return 0;const l=new Date(e.value.ngayNhan),C=new Date(e.value.ngayTra)-l;return Math.ceil(C/(1e3*60*60*24))}),G=V(()=>r.value.giaPhong*k.value),z=V(()=>e.value.cccd&&e.value.sdt&&e.value.ngayNhan&&e.value.ngayTra&&!Object.values(v.value).some(l=>l)),j=V(()=>r.value.tienNghiList||[]),T=l=>new Intl.NumberFormat("vi-VN").format(l),S=l=>{switch(l){case"cccd":v.value.cccd=e.value.cccd.length<9?"CCCD phải có ít nhất 9 số":"";break;case"sdt":const n=/^[0-9]{10,11}$/;v.value.sdt=n.test(e.value.sdt)?"":"Số điện thoại không hợp lệ";break;case"ngayNhan":const C=new Date().toISOString().split("T")[0];v.value.ngayNhan=e.value.ngayNhan<C?"Ngày nhận phòng không thể là quá khứ":"";break;case"ngayTra":v.value.ngayTra=e.value.ngayTra<=e.value.ngayNhan?"Ngày trả phòng phải sau ngày nhận phòng":"";break}},R=l=>{l==="soNguoiLon"&&e.value.soNguoiLon<10?e.value.soNguoiLon++:l==="soTreEm"&&e.value.soTreEm<10&&e.value.soTreEm++},q=l=>{l==="soNguoiLon"&&e.value.soNguoiLon>1?e.value.soNguoiLon--:l==="soTreEm"&&e.value.soTreEm>0&&e.value.soTreEm--},Y=()=>{p.value=(p.value+1)%L.value.length},Q=()=>{p.value=p.value===0?L.value.length-1:p.value-1},N=(l,n="success")=>{U.value=l,$.value=n,P.value=!0,setTimeout(()=>{P.value=!1},3e3)},Z=async()=>{if(!z.value){N("Vui lòng điền đầy đủ thông tin!","error");return}b.value=!0,m.value=3;try{await new Promise(l=>setTimeout(l,2e3)),x.value=!0,N("Đặt phòng thành công!"),console.log("Dữ liệu đặt phòng:",{...e.value,maPhong:A,tongTien:G.value})}catch{N("Có lỗi xảy ra. Vui lòng thử lại!","error")}finally{b.value=!1}},J=()=>{x.value=!1},ss=l=>({"Máy lạnh":"https://cdn-icons-png.flaticon.com/512/606/606792.png",Tivi:"https://cdn-icons-png.flaticon.com/512/5110/5110853.png","Wifi miễn phí":"https://cdn-icons-png.flaticon.com/512/2957/2957496.png",Minibar:"https://cdn-icons-png.flaticon.com/512/1511/1511863.png","Bộ trà/cà phê":"https://cdn-icons-png.flaticon.com/512/892/892668.png","Tivi 55 inch":"https://cdn-icons-png.flaticon.com/512/1762/1762766.png"})[l]||"https://cdn-icons-png.flaticon.com/512/565/565547.png",ns=()=>{const l=["12 người khác đang xem phòng này","Đã có 3 lượt đặt trong 24h qua","Ưu đãi kết thúc trong 2 giờ nữa"];F.value=l[Math.floor(Math.random()*l.length)]};return ls(async()=>{try{const l=await X.get(`http://nhom2webkhachsan.runasp.net/api/PhongWithTienNghi/${A}`);l.data?(r.value={...l.data,tienNghiList:JSON.parse(l.data.tienNghi||"[]")},m.value=1):N("Không tìm thấy thông tin phòng.","error")}catch(l){N("Lỗi khi tải thông tin phòng.","error"),console.error("Lỗi:",l)}finally{O.value=!1,setTimeout(()=>{I.value=!0},100)}ns()}),is(()=>[e.value.cccd,e.value.sdt],()=>{e.value.cccd&&e.value.sdt&&(m.value=2)}),(l,n)=>{const C=D("TheHeader"),a=D("va-icon"),M=D("va-input"),es=D("va-textarea"),ts=D("va-select");return c(),u(w,null,[s("header",null,[t(C)]),s("div",ms,[n[51]||(n[51]=s("div",{class:"background-animation"},[s("div",{class:"floating-shape shape-1"}),s("div",{class:"floating-shape shape-2"}),s("div",{class:"floating-shape shape-3"})],-1)),s("div",gs,[s("div",hs,[s("div",{class:g(["step",{active:m.value>=1,completed:m.value>1}])},[s("div",ps,[t(a,{name:m.value>1?"check":"hotel"},null,8,["name"])]),n[15]||(n[15]=s("span",{class:"step-label"},"Thông tin phòng",-1))],2),s("div",{class:g(["progress-line",{active:m.value>=2}])},null,2),s("div",{class:g(["step",{active:m.value>=2,completed:m.value>2}])},[s("div",_s,[t(a,{name:m.value>2?"check":"person"},null,8,["name"])]),n[16]||(n[16]=s("span",{class:"step-label"},"Thông tin khách",-1))],2),s("div",{class:g(["progress-line",{active:m.value>=3}])},null,2),s("div",{class:g(["step",{active:m.value>=3}])},[s("div",ys,[t(a,{name:"payment"})]),n[17]||(n[17]=s("span",{class:"step-label"},"Xác nhận",-1))],2)])]),s("div",bs,[s("div",{class:g(["room-info",{"animate-in":I.value}])},[s("div",fs,[O.value?(c(),u("div",ks,n[18]||(n[18]=[s("div",{class:"loading-spinner"},[s("div",{class:"spinner"}),s("p",null,"Đang tải thông tin phòng...")],-1)]))):(c(),u("div",Ts,[s("div",Ns,[r.value.tinhTrang==="1"?(c(),u("div",Cs,[t(a,{name:"verified"}),n[19]||(n[19]=s("span",null,"Còn trống",-1))])):y("",!0),s("h2",Vs,i(r.value.loaiPhong),1),s("div",ws,[s("div",Ds,[(c(),u(w,null,E(5,o=>t(a,{name:"star",key:o,class:"star"})),64))]),n[20]||(n[20]=s("span",{class:"rating-text"},"4.8/5",-1))])]),s("div",Ps,[s("div",Ls,[s("img",{src:L.value[p.value],alt:r.value.loaiPhong,class:"room-image"},null,8,Ss),s("div",Ms,[s("button",{class:"gallery-btn prev",onClick:Q},[t(a,{name:"chevron_left"})]),s("button",{class:"gallery-btn next",onClick:Y},[t(a,{name:"chevron_right"})])]),s("div",Es,[(c(!0),u(w,null,E(L.value,(o,_)=>(c(),u("span",{key:_,class:g(["indicator",{active:_===p.value}]),onClick:ke=>p.value=_},null,10,Is))),128))])])]),s("div",xs,[s("div",$s,[s("div",Gs,[s("div",Bs,[t(a,{name:"meeting_room"})]),s("div",Os,[n[21]||(n[21]=s("span",{class:"detail-label"},"Mã phòng",-1)),s("span",Us,i(r.value.maPhong),1)])]),s("div",As,[s("div",Fs,[t(a,{name:"layers"})]),s("div",Hs,[n[22]||(n[22]=s("span",{class:"detail-label"},"Tầng",-1)),s("span",zs,i(r.value.tang),1)])]),s("div",Rs,[s("div",qs,[t(a,{name:"bed"})]),s("div",Js,[n[23]||(n[23]=s("span",{class:"detail-label"},"Kiểu giường",-1)),s("span",Ks,i(r.value.kieuGiuong),1)])]),s("div",Ws,[s("div",Xs,[t(a,{name:"attach_money"})]),s("div",js,[n[24]||(n[24]=s("span",{class:"detail-label"},"Giá phòng",-1)),s("span",Ys,i(T(r.value.giaPhong))+"₫",1)])])])]),s("div",Qs,[s("h3",null,[t(a,{name:"description"}),n[25]||(n[25]=h(" Mô tả phòng "))]),s("p",null,i(r.value.moTa),1)]),s("div",Zs,[s("h3",null,[t(a,{name:"star"}),n[26]||(n[26]=h(" Tiện nghi phòng "))]),s("div",sn,[(c(!0),u(w,null,E(j.value,(o,_)=>(c(),u("div",{key:_,class:"amenity-item",style:ds({animationDelay:`${_*.1}s`})},[s("div",nn,[s("img",{src:ss(o),alt:o},null,8,en)]),s("span",tn,i(o),1)],4))),128))])]),s("div",on,[s("div",{class:g(["status-indicator",r.value.tinhTrang==="1"?"available":"unavailable"])},[t(a,{name:r.value.tinhTrang==="1"?"check_circle":"cancel"},null,8,["name"]),s("span",null,i(r.value.tinhTrang==="1"?"Phòng còn trống":"Phòng đã được đặt"),1)],2)]),r.value.tinhTrang==="1"?(c(),u("div",an,[t(a,{name:"schedule",class:"urgency-icon"}),s("div",ln,[n[27]||(n[27]=s("p",null,[s("strong",null,"Chỉ còn 2 phòng với giá này!")],-1)),s("p",null,i(F.value),1)])])):y("",!0)]))])],2),s("div",{class:g(["booking-form-container",{"animate-in":I.value}])},[s("div",cn,[s("div",rn,[s("h2",un,[t(a,{name:"hotel"}),n[28]||(n[28]=h(" Đặt phòng ngay "))]),n[29]||(n[29]=s("p",{class:"form-subtitle"},"Điền thông tin để hoàn tất đặt phòng",-1))]),s("div",dn,[s("div",vn,[s("h3",mn,[t(a,{name:"person"}),n[30]||(n[30]=h(" Thông tin cá nhân "))]),s("div",gn,[s("div",hn,[t(a,{name:"credit_card",class:"input-icon"}),t(M,{modelValue:e.value.cccd,"onUpdate:modelValue":n[0]||(n[0]=o=>e.value.cccd=o),label:"Số CCCD/Passport *",placeholder:"Nhập số CCCD hoặc Passport",class:"form-input",error:v.value.cccd,"error-messages":v.value.cccd,onInput:n[1]||(n[1]=o=>S("cccd"))},null,8,["modelValue","error","error-messages"])])]),s("div",pn,[s("div",_n,[t(a,{name:"phone",class:"input-icon"}),t(M,{modelValue:e.value.sdt,"onUpdate:modelValue":n[2]||(n[2]=o=>e.value.sdt=o),label:"Số điện thoại *",placeholder:"Nhập số điện thoại",class:"form-input",error:v.value.sdt,"error-messages":v.value.sdt,onInput:n[3]||(n[3]=o=>S("sdt"))},null,8,["modelValue","error","error-messages"])])])]),s("div",yn,[s("h3",bn,[t(a,{name:"calendar_today"}),n[31]||(n[31]=h(" Thời gian lưu trú "))]),s("div",fn,[s("div",kn,[s("div",Tn,[t(a,{name:"login",class:"input-icon"}),t(M,{modelValue:e.value.ngayNhan,"onUpdate:modelValue":n[4]||(n[4]=o=>e.value.ngayNhan=o),label:"Ngày nhận phòng *",type:"date",class:"form-input",min:H.value,error:v.value.ngayNhan,"error-messages":v.value.ngayNhan,onInput:n[5]||(n[5]=o=>S("ngayNhan"))},null,8,["modelValue","min","error","error-messages"])])]),s("div",Nn,[s("div",Cn,[t(a,{name:"logout",class:"input-icon"}),t(M,{modelValue:e.value.ngayTra,"onUpdate:modelValue":n[6]||(n[6]=o=>e.value.ngayTra=o),label:"Ngày trả phòng *",type:"date",class:"form-input",min:e.value.ngayNhan||H.value,error:v.value.ngayTra,"error-messages":v.value.ngayTra,onInput:n[7]||(n[7]=o=>S("ngayTra"))},null,8,["modelValue","min","error","error-messages"])])])]),k.value>0?(c(),u("div",Vn,[s("div",wn,[n[32]||(n[32]=s("span",null,"Số đêm lưu trú:",-1)),s("strong",null,i(k.value)+" đêm",1)]),s("div",Dn,[n[33]||(n[33]=s("span",null,"Tổng tiền:",-1)),s("strong",null,i(T(G.value))+"₫",1)])])):y("",!0)]),s("div",Pn,[s("h3",Ln,[t(a,{name:"people"}),n[34]||(n[34]=h(" Số lượng khách "))]),s("div",Sn,[s("div",Mn,[s("div",En,[t(a,{name:"person",class:"counter-icon"}),n[35]||(n[35]=s("div",{class:"counter-details"},[s("span",{class:"counter-label"},"Người lớn"),s("span",{class:"counter-desc"},"Từ 12 tuổi trở lên")],-1))]),s("div",In,[s("button",{class:"counter-btn",onClick:n[8]||(n[8]=o=>q("soNguoiLon")),disabled:e.value.soNguoiLon<=1},[t(a,{name:"remove"})],8,xn),s("span",$n,i(e.value.soNguoiLon),1),s("button",{class:"counter-btn",onClick:n[9]||(n[9]=o=>R("soNguoiLon")),disabled:e.value.soNguoiLon>=10},[t(a,{name:"add"})],8,Gn)])]),s("div",Bn,[s("div",On,[t(a,{name:"child_care",class:"counter-icon"}),n[36]||(n[36]=s("div",{class:"counter-details"},[s("span",{class:"counter-label"},"Trẻ em"),s("span",{class:"counter-desc"},"Từ 2-11 tuổi")],-1))]),s("div",Un,[s("button",{class:"counter-btn",onClick:n[10]||(n[10]=o=>q("soTreEm")),disabled:e.value.soTreEm<=0},[t(a,{name:"remove"})],8,An),s("span",Fn,i(e.value.soTreEm),1),s("button",{class:"counter-btn",onClick:n[11]||(n[11]=o=>R("soTreEm")),disabled:e.value.soTreEm>=10},[t(a,{name:"add"})],8,Hn)])])])]),s("div",zn,[s("h3",Rn,[t(a,{name:"note"}),n[37]||(n[37]=h(" Yêu cầu đặc biệt "))]),s("div",qn,[t(es,{modelValue:e.value.yeuCau,"onUpdate:modelValue":n[12]||(n[12]=o=>e.value.yeuCau=o),label:"Ghi chú thêm",placeholder:"Ví dụ: Phòng tầng cao, giường đôi, không hút thuốc...",class:"form-textarea","max-length":500,counter:""},null,8,["modelValue"])])]),s("div",Jn,[s("h3",Kn,[t(a,{name:"receipt"}),n[38]||(n[38]=h(" Tóm tắt đặt phòng "))]),s("div",Wn,[s("div",Xn,[n[39]||(n[39]=s("span",null,"Loại phòng:",-1)),s("span",null,i(r.value.loaiPhong),1)]),s("div",jn,[n[40]||(n[40]=s("span",null,"Mã phòng:",-1)),s("span",null,i(r.value.maPhong),1)]),k.value>0?(c(),u("div",Yn,[n[41]||(n[41]=s("span",null,"Số đêm:",-1)),s("span",null,i(k.value)+" đêm",1)])):y("",!0),s("div",Qn,[n[42]||(n[42]=s("span",null,"Số khách:",-1)),s("span",null,i(e.value.soNguoiLon+e.value.soTreEm)+" người",1)]),s("div",Zn,[n[43]||(n[43]=s("span",null,"Giá phòng/đêm:",-1)),s("span",null,i(T(r.value.giaPhong))+"₫",1)]),k.value>0?(c(),u("div",se,[n[44]||(n[44]=s("span",null,"Tổng cộng:",-1)),s("span",ne,i(T(G.value))+"₫",1)])):y("",!0)])]),s("div",ee,[s("h3",te,[t(a,{name:"room_service"}),n[45]||(n[45]=h(" Dịch vụ kèm theo "))]),t(ts,{modelValue:B(f),"onUpdate:modelValue":n[13]||(n[13]=o=>cs(f)?f.value=o:f=o),options:l.serviceOptions,multiple:"",placeholder:"Chọn dịch vụ",class:"service-dropdown",clearable:!1,"track-by":"maDichVu",label:"tenDichVu"},{option:K(({option:o})=>[s("div",oe,[s("img",{src:o.hinhAnhDichVu,alt:"",class:"service-img"},null,8,ae),s("span",null,i(o.tenDichVu),1),s("span",le,i(T(o.donGia))+"₫/"+i(o.donViTinh),1)])]),selected:K(({option:o})=>[s("span",null,i(o.tenDichVu),1)]),_:1},8,["modelValue","options"]),B(f).length?(c(),u("div",ie,[(c(!0),u(w,null,E(B(f),o=>(c(),u("div",{key:o.maDichVu},[s("img",{src:o.hinhAnhDichVu,alt:"",class:"service-img-small"},null,8,ce),s("span",null,i(o.tenDichVu),1),s("div",re,[s("button",{onClick:_=>l.decrease(o)},"-",8,ue),s("span",null,i(o.soLuong),1),s("button",{onClick:_=>l.increase(o)},"+",8,de)])]))),128))])):y("",!0)]),s("div",ve,[s("button",{class:g(["submit-button",{loading:b.value}]),disabled:!z.value||r.value.tinhTrang!=="1"||b.value,onClick:Z},[s("div",ge,[b.value?(c(),u("div",he)):(c(),rs(a,{key:0,name:"hotel"})),s("span",null,i(b.value?"Đang xử lý...":"Xác nhận đặt phòng"),1)])],10,me),s("p",pe,[t(a,{name:"info"}),n[46]||(n[46]=h(" Bằng cách đặt phòng, bạn đồng ý với ")),n[47]||(n[47]=s("a",{href:"#",class:"terms-link"},"Điều khoản & Điều kiện",-1)),n[48]||(n[48]=h(" của chúng tôi "))])])])])],2)]),x.value?(c(),u("div",{key:0,class:"modal-overlay",onClick:J},[s("div",{class:"success-modal",onClick:n[14]||(n[14]=us(()=>{},["stop"]))},[s("div",_e,[t(a,{name:"check_circle"})]),n[49]||(n[49]=s("h3",null,"Đặt phòng thành công!",-1)),n[50]||(n[50]=s("p",null," Cảm ơn bạn đã chọn khách sạn của chúng tôi. Chúng tôi sẽ liên hệ với bạn trong thời gian sớm nhất. ",-1)),s("div",{class:"modal-actions"},[s("button",{class:"btn-primary",onClick:J},"Hoàn tất")])])])):y("",!0),P.value?(c(),u("div",{key:1,class:g(["toast",[$.value,{show:P.value}]])},[s("div",ye,[t(a,{name:$.value==="success"?"check_circle":"error",class:"toast-icon"},null,8,["name"]),s("span",null,i(U.value),1)])],2)):y("",!0)])],64)}}},Ce=vs(be,[["__scopeId","data-v-c489d433"]]);export{Ce as default};
