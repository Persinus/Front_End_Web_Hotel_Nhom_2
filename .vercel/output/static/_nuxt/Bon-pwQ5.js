import{K as ss,h as d,H as ns,k as N,l as ts,J as es,c as u,a as s,b as e,i as _,n as m,t as i,F as S,f as $,d as h,g as as,y as os,r as M,o as r,z as ls}from"./SG-_7NVK.js";import{_ as is}from"./DlAUqK2U.js";const cs={class:"booking-page"},rs={class:"progress-container"},us={class:"progress-steps"},ds={class:"step-circle"},vs={class:"step-circle"},gs={class:"step-circle"},ms={class:"main-content"},hs={class:"room-card"},ps={key:0,class:"loading-container"},_s={key:1,class:"room-content"},ys={class:"room-header"},bs={key:0,class:"room-badge"},fs={class:"room-title"},ks={class:"room-rating"},Ts={class:"stars"},Ns={class:"room-gallery"},Cs={class:"main-image"},ws=["src","alt"],Vs={class:"image-overlay"},Ps={class:"image-indicators"},Ls=["onClick"],Ss={class:"room-details"},Ms={class:"detail-grid"},xs={class:"detail-item"},Ds={class:"detail-icon"},Is={class:"detail-content"},Es={class:"detail-value"},$s={class:"detail-item"},Bs={class:"detail-icon"},Gs={class:"detail-content"},Os={class:"detail-value"},Us={class:"detail-item"},Fs={class:"detail-icon"},Hs={class:"detail-content"},zs={class:"detail-value"},As={class:"detail-item price-item"},Ks={class:"detail-icon"},qs={class:"detail-content"},Js={class:"detail-value price"},Rs={class:"room-description"},Ws={class:"amenities-section"},Xs={class:"amenities-grid"},js={class:"amenity-icon"},Ys=["src","alt"],Qs={class:"amenity-text"},Zs={class:"room-status"},sn={key:0,class:"urgency-message"},nn={class:"urgency-content"},tn={class:"booking-form"},en={class:"form-header"},an={class:"form-title"},on={class:"form-content"},ln={class:"form-section"},cn={class:"section-title"},rn={class:"form-group"},un={class:"input-wrapper"},dn={class:"form-group"},vn={class:"input-wrapper"},gn={class:"form-section"},mn={class:"section-title"},hn={class:"date-inputs"},pn={class:"form-group"},_n={class:"input-wrapper"},yn={class:"form-group"},bn={class:"input-wrapper"},fn={key:0,class:"stay-summary"},kn={class:"summary-item"},Tn={class:"summary-item total-price"},Nn={class:"form-section"},Cn={class:"section-title"},wn={class:"guest-counters"},Vn={class:"counter-group"},Pn={class:"counter-info"},Ln={class:"counter-controls"},Sn=["disabled"],Mn={class:"counter-value"},xn=["disabled"],Dn={class:"counter-group"},In={class:"counter-info"},En={class:"counter-controls"},$n=["disabled"],Bn={class:"counter-value"},Gn=["disabled"],On={class:"form-section"},Un={class:"section-title"},Fn={class:"form-group"},Hn={class:"booking-summary"},zn={class:"summary-title"},An={class:"summary-details"},Kn={class:"summary-row"},qn={class:"summary-row"},Jn={key:0,class:"summary-row"},Rn={class:"summary-row"},Wn={class:"summary-row price-breakdown"},Xn={key:1,class:"summary-row total-row"},jn={class:"total-amount"},Yn={class:"form-actions"},Qn=["disabled"],Zn={class:"btn-content"},st={key:1,class:"loading-spinner-btn"},nt={class:"form-note"},tt={class:"success-icon"},et={class:"toast-content"},at={__name:"DatPhong",setup(ot){const q=ns(),{$api:J}=ss(),t=d({cccd:"",sdt:"",ngayNhan:"",ngayTra:"",soNguoiLon:1,soTreEm:0,yeuCau:""}),c=d({tienNghiList:[],giaPhong:0}),B=d(!0),x=d(!1),y=d(!1),D=d(!1),C=d(!1),G=d(""),I=d("success"),g=d(1),p=d(0),v=d({cccd:"",sdt:"",ngayNhan:"",ngayTra:""}),O=q.params.maPhong,w=d(["https://images.unsplash.com/photo-1566073771259-6a8506099945","https://images.unsplash.com/photo-1582719478250-c89cae4dc85b","https://images.unsplash.com/photo-1595576508898-0ad5c879a061"]),U=d(""),F=N(()=>new Date().toISOString().split("T")[0]),b=N(()=>{if(!t.value.ngayNhan||!t.value.ngayTra)return 0;const o=new Date(t.value.ngayNhan),T=new Date(t.value.ngayTra)-o;return Math.ceil(T/(1e3*60*60*24))}),E=N(()=>c.value.giaPhong*b.value),H=N(()=>t.value.cccd&&t.value.sdt&&t.value.ngayNhan&&t.value.ngayTra&&!Object.values(v.value).some(o=>o)),R=N(()=>c.value.tienNghiList||[]),V=o=>new Intl.NumberFormat("vi-VN").format(o),P=o=>{switch(o){case"cccd":v.value.cccd=t.value.cccd.length<9?"CCCD phải có ít nhất 9 số":"";break;case"sdt":const n=/^[0-9]{10,11}$/;v.value.sdt=n.test(t.value.sdt)?"":"Số điện thoại không hợp lệ";break;case"ngayNhan":const T=new Date().toISOString().split("T")[0];v.value.ngayNhan=t.value.ngayNhan<T?"Ngày nhận phòng không thể là quá khứ":"";break;case"ngayTra":v.value.ngayTra=t.value.ngayTra<=t.value.ngayNhan?"Ngày trả phòng phải sau ngày nhận phòng":"";break}},z=o=>{o==="soNguoiLon"&&t.value.soNguoiLon<10?t.value.soNguoiLon++:o==="soTreEm"&&t.value.soTreEm<10&&t.value.soTreEm++},A=o=>{o==="soNguoiLon"&&t.value.soNguoiLon>1?t.value.soNguoiLon--:o==="soTreEm"&&t.value.soTreEm>0&&t.value.soTreEm--},W=()=>{p.value=(p.value+1)%w.value.length},X=()=>{p.value=p.value===0?w.value.length-1:p.value-1},k=(o,n="success")=>{G.value=o,I.value=n,C.value=!0,setTimeout(()=>{C.value=!1},3e3)},j=async()=>{if(!H.value){k("Vui lòng điền đầy đủ thông tin!","error");return}y.value=!0,g.value=3;try{await new Promise(o=>setTimeout(o,2e3)),D.value=!0,k("Đặt phòng thành công!"),console.log("Dữ liệu đặt phòng:",{...t.value,maPhong:O,tongTien:E.value})}catch{k("Có lỗi xảy ra. Vui lòng thử lại!","error")}finally{y.value=!1}},K=()=>{D.value=!1},Y=o=>({"Máy lạnh":"https://cdn-icons-png.flaticon.com/512/606/606792.png",Tivi:"https://cdn-icons-png.flaticon.com/512/5110/5110853.png","Wifi miễn phí":"https://cdn-icons-png.flaticon.com/512/2957/2957496.png",Minibar:"https://cdn-icons-png.flaticon.com/512/1511/1511863.png","Bộ trà/cà phê":"https://cdn-icons-png.flaticon.com/512/892/892668.png","Tivi 55 inch":"https://cdn-icons-png.flaticon.com/512/1762/1762766.png"})[o]||"https://cdn-icons-png.flaticon.com/512/565/565547.png",Q=()=>{const o=["12 người khác đang xem phòng này","Đã có 3 lượt đặt trong 24h qua","Ưu đãi kết thúc trong 2 giờ nữa"];U.value=o[Math.floor(Math.random()*o.length)]};return ts(async()=>{try{const o=await J.get(`http://nhom2webkhachsan.runasp.net/api/PhongWithTienNghi/${O}`);o.data?(c.value={...o.data,tienNghiList:JSON.parse(o.data.tienNghi||"[]")},g.value=1):k("Không tìm thấy thông tin phòng.","error")}catch(o){k("Lỗi khi tải thông tin phòng.","error"),console.error("Lỗi:",o)}finally{B.value=!1,setTimeout(()=>{x.value=!0},100)}Q()}),es(()=>[t.value.cccd,t.value.sdt],()=>{t.value.cccd&&t.value.sdt&&(g.value=2)}),(o,n)=>{const T=M("TheHeader"),a=M("va-icon"),L=M("va-input"),Z=M("va-textarea");return r(),u(S,null,[s("header",null,[e(T)]),s("div",cs,[n[49]||(n[49]=s("div",{class:"background-animation"},[s("div",{class:"floating-shape shape-1"}),s("div",{class:"floating-shape shape-2"}),s("div",{class:"floating-shape shape-3"})],-1)),s("div",rs,[s("div",us,[s("div",{class:m(["step",{active:g.value>=1,completed:g.value>1}])},[s("div",ds,[e(a,{name:g.value>1?"check":"hotel"},null,8,["name"])]),n[14]||(n[14]=s("span",{class:"step-label"},"Thông tin phòng",-1))],2),s("div",{class:m(["progress-line",{active:g.value>=2}])},null,2),s("div",{class:m(["step",{active:g.value>=2,completed:g.value>2}])},[s("div",vs,[e(a,{name:g.value>2?"check":"person"},null,8,["name"])]),n[15]||(n[15]=s("span",{class:"step-label"},"Thông tin khách",-1))],2),s("div",{class:m(["progress-line",{active:g.value>=3}])},null,2),s("div",{class:m(["step",{active:g.value>=3}])},[s("div",gs,[e(a,{name:"payment"})]),n[16]||(n[16]=s("span",{class:"step-label"},"Xác nhận",-1))],2)])]),s("div",ms,[s("div",{class:m(["room-info",{"animate-in":x.value}])},[s("div",hs,[B.value?(r(),u("div",ps,n[17]||(n[17]=[s("div",{class:"loading-spinner"},[s("div",{class:"spinner"}),s("p",null,"Đang tải thông tin phòng...")],-1)]))):(r(),u("div",_s,[s("div",ys,[c.value.tinhTrang==="1"?(r(),u("div",bs,[e(a,{name:"verified"}),n[18]||(n[18]=s("span",null,"Còn trống",-1))])):_("",!0),s("h2",fs,i(c.value.loaiPhong),1),s("div",ks,[s("div",Ts,[(r(),u(S,null,$(5,l=>e(a,{name:"star",key:l,class:"star"})),64))]),n[19]||(n[19]=s("span",{class:"rating-text"},"4.8/5",-1))])]),s("div",Ns,[s("div",Cs,[s("img",{src:w.value[p.value],alt:c.value.loaiPhong,class:"room-image"},null,8,ws),s("div",Vs,[s("button",{class:"gallery-btn prev",onClick:X},[e(a,{name:"chevron_left"})]),s("button",{class:"gallery-btn next",onClick:W},[e(a,{name:"chevron_right"})])]),s("div",Ps,[(r(!0),u(S,null,$(w.value,(l,f)=>(r(),u("span",{key:f,class:m(["indicator",{active:f===p.value}]),onClick:lt=>p.value=f},null,10,Ls))),128))])])]),s("div",Ss,[s("div",Ms,[s("div",xs,[s("div",Ds,[e(a,{name:"meeting_room"})]),s("div",Is,[n[20]||(n[20]=s("span",{class:"detail-label"},"Mã phòng",-1)),s("span",Es,i(c.value.maPhong),1)])]),s("div",$s,[s("div",Bs,[e(a,{name:"layers"})]),s("div",Gs,[n[21]||(n[21]=s("span",{class:"detail-label"},"Tầng",-1)),s("span",Os,i(c.value.tang),1)])]),s("div",Us,[s("div",Fs,[e(a,{name:"bed"})]),s("div",Hs,[n[22]||(n[22]=s("span",{class:"detail-label"},"Kiểu giường",-1)),s("span",zs,i(c.value.kieuGiuong),1)])]),s("div",As,[s("div",Ks,[e(a,{name:"attach_money"})]),s("div",qs,[n[23]||(n[23]=s("span",{class:"detail-label"},"Giá phòng",-1)),s("span",Js,i(V(c.value.giaPhong))+"₫",1)])])])]),s("div",Rs,[s("h3",null,[e(a,{name:"description"}),n[24]||(n[24]=h(" Mô tả phòng "))]),s("p",null,i(c.value.moTa),1)]),s("div",Ws,[s("h3",null,[e(a,{name:"star"}),n[25]||(n[25]=h(" Tiện nghi phòng "))]),s("div",Xs,[(r(!0),u(S,null,$(R.value,(l,f)=>(r(),u("div",{key:f,class:"amenity-item",style:ls({animationDelay:`${f*.1}s`})},[s("div",js,[s("img",{src:Y(l),alt:l},null,8,Ys)]),s("span",Qs,i(l),1)],4))),128))])]),s("div",Zs,[s("div",{class:m(["status-indicator",c.value.tinhTrang==="1"?"available":"unavailable"])},[e(a,{name:c.value.tinhTrang==="1"?"check_circle":"cancel"},null,8,["name"]),s("span",null,i(c.value.tinhTrang==="1"?"Phòng còn trống":"Phòng đã được đặt"),1)],2)]),c.value.tinhTrang==="1"?(r(),u("div",sn,[e(a,{name:"schedule",class:"urgency-icon"}),s("div",nn,[n[26]||(n[26]=s("p",null,[s("strong",null,"Chỉ còn 2 phòng với giá này!")],-1)),s("p",null,i(U.value),1)])])):_("",!0)]))])],2),s("div",{class:m(["booking-form-container",{"animate-in":x.value}])},[s("div",tn,[s("div",en,[s("h2",an,[e(a,{name:"hotel"}),n[27]||(n[27]=h(" Đặt phòng ngay "))]),n[28]||(n[28]=s("p",{class:"form-subtitle"},"Điền thông tin để hoàn tất đặt phòng",-1))]),s("div",on,[s("div",ln,[s("h3",cn,[e(a,{name:"person"}),n[29]||(n[29]=h(" Thông tin cá nhân "))]),s("div",rn,[s("div",un,[e(a,{name:"credit_card",class:"input-icon"}),e(L,{modelValue:t.value.cccd,"onUpdate:modelValue":n[0]||(n[0]=l=>t.value.cccd=l),label:"Số CCCD/Passport *",placeholder:"Nhập số CCCD hoặc Passport",class:"form-input",error:v.value.cccd,"error-messages":v.value.cccd,onInput:n[1]||(n[1]=l=>P("cccd"))},null,8,["modelValue","error","error-messages"])])]),s("div",dn,[s("div",vn,[e(a,{name:"phone",class:"input-icon"}),e(L,{modelValue:t.value.sdt,"onUpdate:modelValue":n[2]||(n[2]=l=>t.value.sdt=l),label:"Số điện thoại *",placeholder:"Nhập số điện thoại",class:"form-input",error:v.value.sdt,"error-messages":v.value.sdt,onInput:n[3]||(n[3]=l=>P("sdt"))},null,8,["modelValue","error","error-messages"])])])]),s("div",gn,[s("h3",mn,[e(a,{name:"calendar_today"}),n[30]||(n[30]=h(" Thời gian lưu trú "))]),s("div",hn,[s("div",pn,[s("div",_n,[e(a,{name:"login",class:"input-icon"}),e(L,{modelValue:t.value.ngayNhan,"onUpdate:modelValue":n[4]||(n[4]=l=>t.value.ngayNhan=l),label:"Ngày nhận phòng *",type:"date",class:"form-input",min:F.value,error:v.value.ngayNhan,"error-messages":v.value.ngayNhan,onInput:n[5]||(n[5]=l=>P("ngayNhan"))},null,8,["modelValue","min","error","error-messages"])])]),s("div",yn,[s("div",bn,[e(a,{name:"logout",class:"input-icon"}),e(L,{modelValue:t.value.ngayTra,"onUpdate:modelValue":n[6]||(n[6]=l=>t.value.ngayTra=l),label:"Ngày trả phòng *",type:"date",class:"form-input",min:t.value.ngayNhan||F.value,error:v.value.ngayTra,"error-messages":v.value.ngayTra,onInput:n[7]||(n[7]=l=>P("ngayTra"))},null,8,["modelValue","min","error","error-messages"])])])]),b.value>0?(r(),u("div",fn,[s("div",kn,[n[31]||(n[31]=s("span",null,"Số đêm lưu trú:",-1)),s("strong",null,i(b.value)+" đêm",1)]),s("div",Tn,[n[32]||(n[32]=s("span",null,"Tổng tiền:",-1)),s("strong",null,i(V(E.value))+"₫",1)])])):_("",!0)]),s("div",Nn,[s("h3",Cn,[e(a,{name:"people"}),n[33]||(n[33]=h(" Số lượng khách "))]),s("div",wn,[s("div",Vn,[s("div",Pn,[e(a,{name:"person",class:"counter-icon"}),n[34]||(n[34]=s("div",{class:"counter-details"},[s("span",{class:"counter-label"},"Người lớn"),s("span",{class:"counter-desc"},"Từ 12 tuổi trở lên")],-1))]),s("div",Ln,[s("button",{class:"counter-btn",onClick:n[8]||(n[8]=l=>A("soNguoiLon")),disabled:t.value.soNguoiLon<=1},[e(a,{name:"remove"})],8,Sn),s("span",Mn,i(t.value.soNguoiLon),1),s("button",{class:"counter-btn",onClick:n[9]||(n[9]=l=>z("soNguoiLon")),disabled:t.value.soNguoiLon>=10},[e(a,{name:"add"})],8,xn)])]),s("div",Dn,[s("div",In,[e(a,{name:"child_care",class:"counter-icon"}),n[35]||(n[35]=s("div",{class:"counter-details"},[s("span",{class:"counter-label"},"Trẻ em"),s("span",{class:"counter-desc"},"Từ 2-11 tuổi")],-1))]),s("div",En,[s("button",{class:"counter-btn",onClick:n[10]||(n[10]=l=>A("soTreEm")),disabled:t.value.soTreEm<=0},[e(a,{name:"remove"})],8,$n),s("span",Bn,i(t.value.soTreEm),1),s("button",{class:"counter-btn",onClick:n[11]||(n[11]=l=>z("soTreEm")),disabled:t.value.soTreEm>=10},[e(a,{name:"add"})],8,Gn)])])])]),s("div",On,[s("h3",Un,[e(a,{name:"note"}),n[36]||(n[36]=h(" Yêu cầu đặc biệt "))]),s("div",Fn,[e(Z,{modelValue:t.value.yeuCau,"onUpdate:modelValue":n[12]||(n[12]=l=>t.value.yeuCau=l),label:"Ghi chú thêm",placeholder:"Ví dụ: Phòng tầng cao, giường đôi, không hút thuốc...",class:"form-textarea","max-length":500,counter:""},null,8,["modelValue"])])]),s("div",Hn,[s("h3",zn,[e(a,{name:"receipt"}),n[37]||(n[37]=h(" Tóm tắt đặt phòng "))]),s("div",An,[s("div",Kn,[n[38]||(n[38]=s("span",null,"Loại phòng:",-1)),s("span",null,i(c.value.loaiPhong),1)]),s("div",qn,[n[39]||(n[39]=s("span",null,"Mã phòng:",-1)),s("span",null,i(c.value.maPhong),1)]),b.value>0?(r(),u("div",Jn,[n[40]||(n[40]=s("span",null,"Số đêm:",-1)),s("span",null,i(b.value)+" đêm",1)])):_("",!0),s("div",Rn,[n[41]||(n[41]=s("span",null,"Số khách:",-1)),s("span",null,i(t.value.soNguoiLon+t.value.soTreEm)+" người",1)]),s("div",Wn,[n[42]||(n[42]=s("span",null,"Giá phòng/đêm:",-1)),s("span",null,i(V(c.value.giaPhong))+"₫",1)]),b.value>0?(r(),u("div",Xn,[n[43]||(n[43]=s("span",null,"Tổng cộng:",-1)),s("span",jn,i(V(E.value))+"₫",1)])):_("",!0)])]),s("div",Yn,[s("button",{class:m(["submit-button",{loading:y.value}]),disabled:!H.value||c.value.tinhTrang!=="1"||y.value,onClick:j},[s("div",Zn,[y.value?(r(),u("div",st)):(r(),as(a,{key:0,name:"hotel"})),s("span",null,i(y.value?"Đang xử lý...":"Xác nhận đặt phòng"),1)])],10,Qn),s("p",nt,[e(a,{name:"info"}),n[44]||(n[44]=h(" Bằng cách đặt phòng, bạn đồng ý với ")),n[45]||(n[45]=s("a",{href:"#",class:"terms-link"},"Điều khoản & Điều kiện",-1)),n[46]||(n[46]=h(" của chúng tôi "))])])])])],2)]),D.value?(r(),u("div",{key:0,class:"modal-overlay",onClick:K},[s("div",{class:"success-modal",onClick:n[13]||(n[13]=os(()=>{},["stop"]))},[s("div",tt,[e(a,{name:"check_circle"})]),n[47]||(n[47]=s("h3",null,"Đặt phòng thành công!",-1)),n[48]||(n[48]=s("p",null,"Cảm ơn bạn đã chọn khách sạn của chúng tôi. Chúng tôi sẽ liên hệ với bạn trong thời gian sớm nhất.",-1)),s("div",{class:"modal-actions"},[s("button",{class:"btn-primary",onClick:K}," Hoàn tất ")])])])):_("",!0),C.value?(r(),u("div",{key:1,class:m(["toast",[I.value,{show:C.value}]])},[s("div",et,[e(a,{name:I.value==="success"?"check_circle":"error",class:"toast-icon"},null,8,["name"]),s("span",null,i(G.value),1)])],2)):_("",!0)])],64)}}},rt=is(at,[["__scopeId","data-v-a5cbd3d5"]]);export{rt as default};
